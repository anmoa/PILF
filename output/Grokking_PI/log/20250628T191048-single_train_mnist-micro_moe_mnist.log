Logging output to: output/ViT/Grokking_PI\log\20250628T191048-single_train_mnist-micro_moe_mnist.log
Model Suffix: -single_train_mnist
Total Trainable Parameters: 0.16M
Using parameter groups for optimizer.

==================== CYCLE 1/1 ====================

--- Training on MNIST for 50 epoch(s) ---
Train Epoch 1 Summary: Avg loss: 2.0260, Avg Accuracy: 25.90%, Avg PI: 0.3859, Avg Surprise: 0.9875, Avg Tau: 2.0745
Train Epoch 2 Summary: Avg loss: 1.4539, Avg Accuracy: 47.98%, Avg PI: 0.2124, Avg Surprise: 2.5458, Avg Tau: 1.6037
Train Epoch 3 Summary: Avg loss: 1.1648, Avg Accuracy: 59.17%, Avg PI: 0.1602, Avg Surprise: 3.1266, Avg Tau: 1.3452
Train Epoch 4 Summary: Avg loss: 0.9007, Avg Accuracy: 69.02%, Avg PI: 0.1577, Avg Surprise: 3.0723, Avg Tau: 1.1045
Train Epoch 5 Summary: Avg loss: 0.7152, Avg Accuracy: 75.57%, Avg PI: 0.1529, Avg Surprise: 3.1952, Avg Tau: 0.8801
Train Epoch 6 Summary: Avg loss: 0.5723, Avg Accuracy: 81.09%, Avg PI: 0.1608, Avg Surprise: 3.0138, Avg Tau: 0.7100
Train Epoch 7 Summary: Avg loss: 0.4493, Avg Accuracy: 85.45%, Avg PI: 0.1737, Avg Surprise: 2.9119, Avg Tau: 0.5633
Train Epoch 8 Summary: Avg loss: 0.3597, Avg Accuracy: 88.71%, Avg PI: 0.1870, Avg Surprise: 2.6947, Avg Tau: 0.4570
Train Epoch 9 Summary: Avg loss: 0.3073, Avg Accuracy: 90.42%, Avg PI: 0.1915, Avg Surprise: 2.6673, Avg Tau: 0.3794
Train Epoch 10 Summary: Avg loss: 0.2749, Avg Accuracy: 91.40%, Avg PI: 0.1923, Avg Surprise: 2.6805, Avg Tau: 0.3351
Train Epoch 11 Summary: Avg loss: 0.2424, Avg Accuracy: 92.42%, Avg PI: 0.2182, Avg Surprise: 2.3323, Avg Tau: 0.2896
Train Epoch 12 Summary: Avg loss: 0.2304, Avg Accuracy: 92.74%, Avg PI: 0.2102, Avg Surprise: 2.4460, Avg Tau: 0.2740
Train Epoch 13 Summary: Avg loss: 0.1988, Avg Accuracy: 93.92%, Avg PI: 0.2791, Avg Surprise: 1.7636, Avg Tau: 0.2387
Train Epoch 14 Summary: Avg loss: 0.1863, Avg Accuracy: 94.18%, Avg PI: 0.2758, Avg Surprise: 1.7784, Avg Tau: 0.2174
Train Epoch 15 Summary: Avg loss: 0.1732, Avg Accuracy: 94.61%, Avg PI: 0.3174, Avg Surprise: 1.4511, Avg Tau: 0.1998
Train Epoch 16 Summary: Avg loss: 0.1633, Avg Accuracy: 94.88%, Avg PI: 0.3172, Avg Surprise: 1.4480, Avg Tau: 0.1869
Train Epoch 17 Summary: Avg loss: 0.1514, Avg Accuracy: 95.30%, Avg PI: 0.3207, Avg Surprise: 1.4123, Avg Tau: 0.1715
Train Epoch 18 Summary: Avg loss: 0.1432, Avg Accuracy: 95.55%, Avg PI: 0.3183, Avg Surprise: 1.4226, Avg Tau: 0.1605
Train Epoch 19 Summary: Avg loss: 0.1352, Avg Accuracy: 95.76%, Avg PI: 0.3379, Avg Surprise: 1.3062, Avg Tau: 0.1515
Train Epoch 20 Summary: Avg loss: 0.1220, Avg Accuracy: 96.20%, Avg PI: 0.3974, Avg Surprise: 1.0014, Avg Tau: 0.1435
Train Epoch 21 Summary: Avg loss: 0.1195, Avg Accuracy: 96.18%, Avg PI: 0.3792, Avg Surprise: 1.0637, Avg Tau: 0.1319
Train Epoch 22 Summary: Avg loss: 0.1124, Avg Accuracy: 96.42%, Avg PI: 0.3798, Avg Surprise: 1.0591, Avg Tau: 0.1252
Train Epoch 23 Summary: Avg loss: 0.1072, Avg Accuracy: 96.59%, Avg PI: 0.3892, Avg Surprise: 1.0033, Avg Tau: 0.1195
Train Epoch 24 Summary: Avg loss: 0.1023, Avg Accuracy: 96.79%, Avg PI: 0.4060, Avg Surprise: 0.9327, Avg Tau: 0.1149
Train Epoch 25 Summary: Avg loss: 0.0991, Avg Accuracy: 96.87%, Avg PI: 0.3969, Avg Surprise: 0.9474, Avg Tau: 0.1092
Train Epoch 26 Summary: Avg loss: 0.0951, Avg Accuracy: 96.97%, Avg PI: 0.3950, Avg Surprise: 0.9710, Avg Tau: 0.1052
Train Epoch 27 Summary: Avg loss: 0.0872, Avg Accuracy: 97.22%, Avg PI: 0.4266, Avg Surprise: 0.8311, Avg Tau: 0.0987
Train Epoch 28 Summary: Avg loss: 0.0906, Avg Accuracy: 97.13%, Avg PI: 0.3781, Avg Surprise: 1.0629, Avg Tau: 0.1010
Train Epoch 29 Summary: Avg loss: 0.0840, Avg Accuracy: 97.34%, Avg PI: 0.4137, Avg Surprise: 0.8621, Avg Tau: 0.0917
Train Epoch 30 Summary: Avg loss: 0.0801, Avg Accuracy: 97.41%, Avg PI: 0.4262, Avg Surprise: 0.8252, Avg Tau: 0.0896
Train Epoch 31 Summary: Avg loss: 0.0752, Avg Accuracy: 97.54%, Avg PI: 0.4374, Avg Surprise: 0.7538, Avg Tau: 0.0830
Train Epoch 32 Summary: Avg loss: 0.0728, Avg Accuracy: 97.70%, Avg PI: 0.4317, Avg Surprise: 0.7871, Avg Tau: 0.0809
Train Epoch 33 Summary: Avg loss: 0.0696, Avg Accuracy: 97.76%, Avg PI: 0.4487, Avg Surprise: 0.7328, Avg Tau: 0.0791
Train Epoch 34 Summary: Avg loss: 0.0669, Avg Accuracy: 97.72%, Avg PI: 0.4377, Avg Surprise: 0.7766, Avg Tau: 0.0753
Train Epoch 35 Summary: Avg loss: 0.0690, Avg Accuracy: 97.71%, Avg PI: 0.4214, Avg Surprise: 0.8271, Avg Tau: 0.0750
Train Epoch 36 Summary: Avg loss: 0.0658, Avg Accuracy: 97.89%, Avg PI: 0.4421, Avg Surprise: 0.7265, Avg Tau: 0.0716
Train Epoch 37 Summary: Avg loss: 0.0638, Avg Accuracy: 97.96%, Avg PI: 0.4311, Avg Surprise: 0.7742, Avg Tau: 0.0697
Train Epoch 38 Summary: Avg loss: 0.0632, Avg Accuracy: 97.97%, Avg PI: 0.4336, Avg Surprise: 0.7485, Avg Tau: 0.0677
Train Epoch 39 Summary: Avg loss: 0.0593, Avg Accuracy: 98.09%, Avg PI: 0.4655, Avg Surprise: 0.6498, Avg Tau: 0.0669
Train Epoch 40 Summary: Avg loss: 0.0536, Avg Accuracy: 98.28%, Avg PI: 0.4876, Avg Surprise: 0.5836, Avg Tau: 0.0620
Train Epoch 41 Summary: Avg loss: 0.0560, Avg Accuracy: 98.15%, Avg PI: 0.4454, Avg Surprise: 0.7058, Avg Tau: 0.0604
Train Epoch 42 Summary: Avg loss: 0.0555, Avg Accuracy: 98.20%, Avg PI: 0.4533, Avg Surprise: 0.6764, Avg Tau: 0.0604
Train Epoch 43 Summary: Avg loss: 0.0533, Avg Accuracy: 98.22%, Avg PI: 0.4529, Avg Surprise: 0.6737, Avg Tau: 0.0581
Train Epoch 44 Summary: Avg loss: 0.0520, Avg Accuracy: 98.28%, Avg PI: 0.4699, Avg Surprise: 0.6303, Avg Tau: 0.0588
Train Epoch 45 Summary: Avg loss: 0.0549, Avg Accuracy: 98.20%, Avg PI: 0.4315, Avg Surprise: 0.7119, Avg Tau: 0.0560
Train Epoch 46 Summary: Avg loss: 0.0495, Avg Accuracy: 98.39%, Avg PI: 0.4637, Avg Surprise: 0.6842, Avg Tau: 0.0572
Train Epoch 47 Summary: Avg loss: 0.0477, Avg Accuracy: 98.43%, Avg PI: 0.4715, Avg Surprise: 0.6183, Avg Tau: 0.0532
Train Epoch 48 Summary: Avg loss: 0.0459, Avg Accuracy: 98.46%, Avg PI: 0.4814, Avg Surprise: 0.5971, Avg Tau: 0.0522
Train Epoch 49 Summary: Avg loss: 0.0452, Avg Accuracy: 98.57%, Avg PI: 0.4726, Avg Surprise: 0.5855, Avg Tau: 0.0491
Train Epoch 50 Summary: Avg loss: 0.0441, Avg Accuracy: 98.58%, Avg PI: 0.4822, Avg Surprise: 0.5802, Avg Tau: 0.0494

--- Validating at global step: 1500 ---
MNIST Validation set: Avg loss: 0.0595, Accuracy: 98.25%, Avg PI: 0.3081, Avg Surprise: 0.5887, Avg Tau: 0.0323
FashionMNIST Validation set: Avg loss: 6.9613, Accuracy: 9.03%, Avg PI: 0.0000, Avg Surprise: 23.9854, Avg Tau: 0.4415

Final checkpoint saved.

Plots saved to: E:\Dev\Chain\PILF\output\ViT\Grokking_PI\img\20250628T191048-single_train_mnist-micro_moe_mnist-Metrics.png

Plots saved to: E:\Dev\Chain\PILF\output\ViT\Grokking_PI\img
